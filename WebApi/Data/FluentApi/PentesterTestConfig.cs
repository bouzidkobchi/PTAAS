using Microsoft.EntityFrameworkCore;
using WebApi.Models;

namespace WebApi.Data.FluentApi
{
    public static class PentesterTestConfig
    {
        public static ModelBuilder AddPentesterTestEntity(this ModelBuilder modelBuilder)
        {
            var PentesterTestEntity = modelBuilder.Entity<PentesterTest>();

            PentesterTestEntity.ToTable("PentestersAssignedTests")
                .HasKey(pt => new { pt.PentesterId, pt.TestId });

            PentesterTestEntity.HasOne(pgt => pgt.Test)
                .WithMany()
                .OnDelete(DeleteBehavior.NoAction)
                .HasForeignKey(pt => pt.TestId);

            PentesterTestEntity.HasOne(pt => pt.Pentester)
                .WithMany()
                .OnDelete(DeleteBehavior.NoAction)
                .HasForeignKey(pt => pt.PentesterId);

            return modelBuilder;
        }
    }
}
